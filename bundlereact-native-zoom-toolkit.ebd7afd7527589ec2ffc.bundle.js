"use strict";(self.webpackChunklahelu_client=self.webpackChunklahelu_client||[]).push([[625],{61373:(e,t,a)=>{a.r(t),a.d(t,{CropZoom:()=>X,Gallery:()=>F,ResumableZoom:()=>E,SnapbackZoom:()=>r,fitContainer:()=>B,stackTransition:()=>N,useImageResolution:()=>Z,useTransformationState:()=>_});var n=a(96540),l=a(23193),i=a(56963);const o=(e,t)=>({x:(0,l.useSharedValue)(e),y:(0,l.useSharedValue)(t)}),u=(e,t)=>({width:(0,l.useSharedValue)(e),height:(0,l.useSharedValue)(t)}),h={vertical:0,horizontal:0},r=(s=({children:e,hitSlop:t=h,resizeConfig:a,timingConfig:r,gesturesEnabled:s=!0,scrollRef:c,onTap:v,onDoubleTap:d,onPinchStart:g,onPinchEnd:w,onUpdate:m,onGestureEnd:x})=>{const y=(0,l.useAnimatedRef)(),S=o(0,0),p=(0,l.useSharedValue)(1),f=o(0,0),b=o(0,0),M=o(0,0),E=o(0,0),P=u((null==a?void 0:a.size.width)??0,(null==a?void 0:a.size.height)??0),T=()=>{const e=(0,l.measure)(y);null!==e&&(P.width.value=e.width,P.height.value=e.height,f.x.value=e.pageX,f.y.value=e.pageY)},z=(0,l.useDerivedValue)((()=>(({resizeConfig:e,width:t,height:a,scale:n})=>{let i=t,o=a;if(void 0!==e){const{size:t,aspectRatio:a,scale:u}=e,h=a>1;i=h?(0,l.interpolate)(n,[1,u],[t.width,t.height*a],l.Extrapolation.CLAMP):t.width,o=h?t.height:(0,l.interpolate)(n,[1,u],[t.height,t.width/a],l.Extrapolation.CLAMP)}return{width:i,height:o,deltaX:(i-t)/2,deltaY:(o-a)/2}})({resizeConfig:a,width:P.width.value,height:P.height.value,scale:p.value})),[a,P,p]);(0,l.useDerivedValue)((()=>{const{width:e,height:t}=z.value;null==m||m({x:f.x.value,y:f.y.value,width:P.width.value,height:P.height.value,resizedWidth:a?e:void 0,resizedHeight:a?t:void 0,translateX:S.x.value,translateY:S.y.value,scale:p.value})}),[z,f,P,a,S,p]);const I=i.Gesture.Pinch().withTestId("pinch").hitSlop(t).enabled(s).onTouchesMove((e=>{if(2!==e.numberOfTouches)return;const t=e.allTouches[0],a=e.allTouches[1];E.x.value=(t.absoluteX+a.absoluteX)/2,E.y.value=(t.absoluteY+a.absoluteY)/2})).onStart((e=>{T(),g&&g(e),M.x.value=E.x.value,M.y.value=E.y.value,b.x.value=e.focalX-P.width.value/2,b.y.value=e.focalY-P.height.value/2})).onUpdate((e=>{T();const t=E.x.value-M.x.value,a=E.y.value-M.y.value,n=-1*(b.x.value*e.scale-b.x.value)+t,l=-1*(b.y.value*e.scale-b.y.value)+a;S.x.value=n,S.y.value=l,p.value=e.scale})).onEnd((e=>{w&&(0,l.runOnJS)(w)(e),S.x.value=(0,l.withTiming)(0,r),S.y.value=(0,l.withTiming)(0,r),p.value=(0,l.withTiming)(1,r,(e=>{x&&(0,l.runOnJS)(x)()}))}));void 0!==c&&I.blocksExternalGesture(c);const O=i.Gesture.Tap().withTestId("tap").enabled(s).maxDuration(250).numberOfTaps(1).runOnJS(!0).onEnd((e=>null==v?void 0:v(e))),V=i.Gesture.Tap().withTestId("doubleTap").enabled(s).numberOfTaps(2).maxDuration(250).runOnJS(!0).onEnd((e=>null==d?void 0:d(e))),X=(0,l.useAnimatedStyle)((()=>({width:null==a?void 0:a.size.width,height:null==a?void 0:a.size.height,justifyContent:"center",alignItems:"center"})),[a]),Y=(0,l.useAnimatedStyle)((()=>{const{width:e,height:t,deltaX:a,deltaY:n}=z.value;return{width:0===e?void 0:e,height:0===t?void 0:t,transform:[{translateX:S.x.value-a},{translateY:S.y.value-n},{scale:p.value}]}}),[z,S,p]),C=i.Gesture.Exclusive(V,O);return n.createElement(i.GestureDetector,{gesture:i.Gesture.Race(I,C)},n.createElement(l.default.View,{style:X,ref:y},n.createElement(l.default.View,{style:Y},e)))},e=>{const t=n.Children.count(e.children);if(1!==t)throw new Error(`SnapbackZoom expected one child but received ${t} children`);return n.createElement(s,e)});var s,c=a(9176),v=a(43999);const d=(e,t,a)=>Math.max(t,Math.min(e,a)),g=(e,t)=>t.width>t.height?Math.max(1,t.width/e.width):Math.max(1,t.height/e.height),w=e=>1*Math.pow(1-e,2),m=(e,t)=>{const{time:a,boundaries:n,position:l,translate:i}=t,o=performance.now()-a,{x:u,y:h}=n,r=Math.abs(l.x-e.absoluteX)>=20,s=Math.abs(l.y-e.absoluteY)>=20,c=o<=175,v=e.velocityX>=500&&r&&c,d=i.x===u;if(v&&d)return"right";const g=e.velocityX<=-500&&r&&c,w=i.x===-1*u;if(g&&w)return"left";const m=e.velocityY<=-500&&s&&c,x=i.y===-1*h;if(m&&x)return"up";const y=e.velocityY>=500&&s&&c,S=i.y===h;return y&&S?"down":void 0},x=e=>{const{container:t,translate:a,offset:n,panMode:i,decay:u,boundFn:h,userCallbacks:r}=e,{onSwipe:s,onGestureEnd:c,onOverPanning:v}=r,g=(0,l.useSharedValue)(0),x=o(0,0),y=(0,l.useSharedValue)(0),S=(0,l.useSharedValue)(!0),p=(0,l.useSharedValue)(!0);return{onPanStart:e=>{r.onPanStart&&(0,l.runOnJS)(r.onPanStart)(e),(0,l.cancelAnimation)(a.x),(0,l.cancelAnimation)(a.y),n.x.value=a.x.value,n.y.value=a.y.value,g.value=performance.now(),x.x.value=e.absoluteX,x.y.value=e.absoluteY},onPanChange:e=>{const l=e.translationX+n.x.value,o=e.translationY+n.y.value,{x:u,y:r}=h(),s=Math.max(0,Math.abs(l)-u),c=Math.max(0,Math.abs(o)-r);if(S.value=0===s,p.value=0===c,(s>0||c>0)&&v){const e=Math.sign(l)*s,t=Math.sign(o)*c;v(e,t)}if("friction"!==i){const e="free"===i;return a.x.value=e?l:d(l,-1*u,u),void(a.y.value=e?o:d(o,-1*r,r))}const g=1.5*Math.max(t.width.value,t.height.value);if(S.value)a.x.value=l;else{const t=Math.abs(Math.abs(l)-u)/g,n=w(d(t,0,1));a.x.value+=e.changeX*n}if(p.value)a.y.value=o;else{const t=Math.abs(Math.abs(o)-r)/g,n=w(d(t,0,1));a.y.value+=e.changeY*n}},onPanEnd:e=>{if("clamp"===i&&s){const t=h(),n=m(e,{boundaries:t,time:g.value,position:{x:x.x.value,y:x.y.value},translate:{x:a.x.value,y:a.y.value}});if(void 0!==n)return void(0,l.runOnJS)(s)(n)}r.onPanEnd&&(0,l.runOnJS)(r.onPanEnd)(e);const{x:t,y:n}=h(),o=[-1*t,t],v=[-1*n,n],w=d(a.x.value,-1*t,t),f=d(a.y.value,-1*n,n),b=u&&S.value,M=u&&p.value,E={velocity:e.velocityX,clamp:o},P={velocity:e.velocityY,clamp:v};a.x.value=b?(0,l.withDecay)(E):(0,l.withTiming)(w),a.y.value=M?(0,l.withDecay)(P):(0,l.withTiming)(f);const T=Math.abs(Math.abs(a.x.value)-t),z=Math.abs(Math.abs(a.y.value)-n);if(y.value=T>z?a.x.value:a.y.value,b||M){const e=T>z?E:P;y.value=(0,l.withDecay)(e,(e=>{e&&c&&(0,l.runOnJS)(c)()}))}else{const e=T>z?w:f;y.value=(0,l.withTiming)(e,void 0,(e=>{e&&c&&(0,l.runOnJS)(c)()}))}}}},y=e=>{const{toScale:t,fromScale:a,delta:n,origin:l,offset:i}=e,o=-1*(l.x*a-l.x),u=-1*(l.y*a-l.y),h=-1*(l.x*t-l.x),r=-1*(l.y*t-l.y);return{x:i.x+h-o+n.x,y:i.y+r-u+n.y}},S=e=>{const{container:t,translate:a,offset:i,scale:u,scaleOffset:h,minScale:r,maxScale:s,scaleMode:c,pinchCenteringMode:v,allowPinchPanning:g,boundFn:w,userCallbacks:m}=e,x="clamp"===v,S="clamp"===c,p=o(0,0),f=o(0,0),b=o(0,0),M=(0,l.useSharedValue)(0),[E,P]=(0,n.useState)(!0),T=e=>{"bounce"===c&&P(e)};return{gesturesEnabled:E,onTouchesDown:(e,t)=>{2===e.numberOfTouches&&t.begin()},onTouchesMove:(e,t)=>{if(2!==e.numberOfTouches)return;const a=e.allTouches[0],n=e.allTouches[1];f.x.value=(a.absoluteX+n.absoluteX)/2,f.y.value=(a.absoluteY+n.absoluteY)/2,t.activate()},onTouchesUp:(e,t)=>{2!==e.numberOfTouches&&t.end()},onPinchStart:e=>{(0,l.runOnJS)(T)(!1),m.onPinchStart&&(0,l.runOnJS)(m.onPinchStart)(e),(0,l.cancelAnimation)(a.x),(0,l.cancelAnimation)(a.y),(0,l.cancelAnimation)(u),p.x.value=f.x.value,p.y.value=f.y.value,b.x.value=e.focalX-t.width.value/2,b.y.value=e.focalY-t.height.value/2,i.x.value=a.x.value,i.y.value=a.y.value,h.value=u.value},onPinchUpdate:e=>{let t=e.scale*h.value;S&&(t=d(t,r,s.value));const n=f.x.value-p.x.value,l=f.y.value-p.y.value,{x:o,y:c}=y({toScale:t,fromScale:h.value,origin:{x:b.x.value,y:b.y.value},offset:{x:i.x.value,y:i.y.value},delta:{x:g?n:0,y:g?l:0}}),{x:v,y:m}=w(t),M=d(o,-1*v,v),E=d(c,-1*m,m);a.x.value=x?M:o,a.y.value=x?E:c,u.value=t},onPinchEnd:e=>{m.onPinchEnd&&(0,l.runOnJS)(m.onPinchEnd)(e);const t=d(u.value,r,s.value),n=!S&&g&&u.value>s.value?(f.y.value-p.y.value)/2:0,{x:i,y:o}=y({toScale:t,fromScale:u.value,origin:{x:b.x.value,y:b.y.value},offset:{x:a.x.value,y:a.y.value},delta:{x:0,y:n}}),{x:c,y:v}=w(t);((e,t,n)=>{(0,l.cancelAnimation)(a.x),(0,l.cancelAnimation)(a.y),(0,l.cancelAnimation)(u);const i=a.x.value!==e,o=a.y.value!==t,r=u.value!==n,s=i||o||r?1:0;a.x.value=(0,l.withTiming)(e),a.y.value=(0,l.withTiming)(t),u.value=(0,l.withTiming)(n,void 0,(e=>{h.value=u.value,e&&(0,l.runOnJS)(T)(!0)})),M.value=(0,l.withTiming)(s,void 0,(e=>{M.value=0,e&&void 0!==m.onGestureEnd&&(0,l.runOnJS)(m.onGestureEnd)()}))})(d(i,-1*c,c),d(o,-1*v,v),t)}}},p=({container:e,translate:t,scale:a,minScale:n,maxScale:i,scaleOffset:o,boundsFn:u,onGestureEnd:h})=>({onDoubleTapEnd:r=>{const s=r.x-e.width.value/2,c=r.y-e.height.value/2,v=a.value>=.8*i.value?n:i.value,{x:g,y:w}=y({toScale:v,fromScale:a.value,origin:{x:s,y:c},delta:{x:0,y:0},offset:{x:t.x.value,y:t.y.value}}),{x:m,y:x}=u(v),S=d(g,-1*m,m),p=d(w,-1*x,x);t.x.value=(0,l.withTiming)(S),t.y.value=(0,l.withTiming)(p),o.value=v,a.value=(0,l.withTiming)(v,void 0,(e=>{e&&h&&(0,l.runOnJS)(h)()}))}});function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},f.apply(this,arguments)}const b=e=>{const{scale:t,translation:a,itemSize:n,containerSize:l}=e,i=(n.width*t-l.width)/2,o=(n.height*t-l.height)/2,u=Math.max(i,0),h=Math.max(o,0),r=(-1*a.x+u)/(n.width*t),s=(-1*a.y+h)/(n.height*t);return{x:n.width*r,y:n.height*s,width:n.width*Math.min(1,l.width/(n.width*t)),height:n.height*Math.min(1,l.height/(n.height*t))}},M=v.default.create({flex:{flex:1},center:{justifyContent:"center",alignItems:"center"}}),E=function(e){return(0,n.forwardRef)(((t,a)=>{const{minScale:l,maxScale:i,children:o}=t,u=n.Children.count(o);if(1!==u)throw new Error(`ResumableZoom expected one child but received ${u} children`);if(void 0!==l&&l<1)throw new Error("minScale must be greater than or equals one");const h="number"==typeof i;if(h&&i<1)throw new Error("maxScale must be greater than one, or a SizeVector object in order to infer the max scale");if(l&&h&&l>i)throw new Error("minScale must not be greater maxScale");return n.createElement(e,f({},t,{reference:a}))}))}((e=>{const{reference:t,children:a,style:h,extendGestures:r=!1,decay:s=!0,tapsEnabled:v=!0,panEnabled:w=!0,pinchEnabled:m=!0,minScale:y=1,maxScale:f=6,panMode:E="clamp",scaleMode:P="bounce",pinchCenteringMode:T="clamp",allowPinchPanning:z=!0,onTap:I,onUpdate:O,onGestureEnd:V,onSwipe:X,onPinchStart:Y,onPinchEnd:C,onPanStart:A,onPanEnd:G,onOverPanning:D}=e,J=u(1,1),R=u(1,1),U=u(1,1),j=o(0,0),k=o(0,0),F=(0,l.useSharedValue)(y),H=(0,l.useSharedValue)(y),Z=(0,l.useDerivedValue)((()=>"object"==typeof f?g({width:R.width.value,height:R.height.value},f):f),[f,R]);(0,l.useDerivedValue)((()=>{U.width.value=r?Math.max(J.width.value,R.width.value):R.width.value,U.height.value=r?Math.max(J.height.value,R.height.value):R.height.value}),[r,J,R]);const W=e=>{const t=e??F.value,{width:a,height:n}=R,{width:l,height:i}=J;return{x:Math.max(0,a.value*t-l.value)/2,y:Math.max(0,n.value*t-i.value)/2}},L=(e,t,a,n)=>{j.x.value=n?(0,l.withTiming)(e):e,j.y.value=n?(0,l.withTiming)(t):t,F.value=n?(0,l.withTiming)(a):a,H.value=a};(0,l.useDerivedValue)((()=>{null==O||O({width:R.width.value,height:R.height.value,translateX:j.x.value,translateY:j.y.value,scale:F.value})}),[R,j,F]);const{gesturesEnabled:$,onTouchesDown:q,onTouchesMove:_,onTouchesUp:B,onPinchStart:N,onPinchUpdate:K,onPinchEnd:Q}=S({container:U,translate:j,offset:k,scale:F,scaleOffset:H,minScale:y,maxScale:Z,allowPinchPanning:z,scaleMode:P,pinchCenteringMode:T,boundFn:W,userCallbacks:{onGestureEnd:V,onPinchStart:Y,onPinchEnd:C}}),{onPanStart:ee,onPanChange:te,onPanEnd:ae}=x({container:U,translate:j,offset:k,panMode:E,boundFn:W,decay:s,userCallbacks:{onSwipe:X,onGestureEnd:V,onPanStart:A,onPanEnd:G,onOverPanning:D}}),{onDoubleTapEnd:ne}=p({container:U,translate:j,scale:F,minScale:y,maxScale:Z,scaleOffset:H,boundsFn:W,onGestureEnd:V}),le=i.Gesture.Pinch().withTestId("pinch").enabled(m).manualActivation(!0).onTouchesDown(q).onTouchesMove(_).onTouchesUp(B).onStart(N).onUpdate(K).onEnd(Q),ie=i.Gesture.Pan().withTestId("pan").enabled(w&&$).maxPointers(1).onStart(ee).onChange(te).onEnd(ae),oe=i.Gesture.Tap().withTestId("tap").enabled(v&&$).maxDuration(250).numberOfTaps(1).runOnJS(!0).onEnd((e=>null==I?void 0:I(e))),ue=i.Gesture.Tap().withTestId("doubleTap").enabled(v&&$).maxDuration(250).numberOfTaps(2).onEnd(ne),he=(0,l.useAnimatedStyle)((()=>({width:U.width.value,height:U.height.value,transform:[{translateX:j.x.value},{translateY:j.y.value},{scale:F.value}]})),[U,j,F]),re=()=>({width:R.width.value,height:R.height.value,translateX:j.x.value,translateY:j.y.value,scale:F.value}),se=(e,t=!0)=>{const a=d(e.scale,y,Z.value),{x:n,y:l}=W(a),i=d(e.translateX,-1*n,n),o=d(e.translateY,-1*l,l);L(i,o,a,t)},ce=()=>b({scale:F.value,itemSize:{width:R.width.value,height:R.height.value},containerSize:{width:J.width.value,height:J.height.value},translation:{x:j.x.value,y:j.y.value}}),ve=(e,t)=>{const a=F.value*e;let n=t;if(void 0===n){const e=ce();n={x:e.x+e.width/2,y:e.y+e.height/2}}const l=R.width.value/2,i=R.height.value/2,o=n.x-l,u=n.y-i,h=l-n.x+(o-o*a),r=i-n.y+(u-u*a),{x:s,y:c}=W(a),v=d(h,-1*s,s),g=d(r,-1*c,c);L(v,g,a,!0)};(0,n.useImperativeHandle)(t,(()=>({reset:(e=!0)=>L(0,0,y,e),requestState:re,assignState:se,zoom:ve,getVisibleRect:ce})));const de=i.Gesture.Exclusive(ue,oe),ge=i.Gesture.Race(le,ie,de);return n.createElement(c.default,{style:[h??M.flex,M.center],onLayout:e=>{J.width.value=e.nativeEvent.layout.width,J.height.value=e.nativeEvent.layout.height}},n.createElement(i.GestureDetector,{gesture:ge},n.createElement(l.default.View,{testID:"root",style:[he,M.center]},n.createElement(l.default.View,{testID:"child",onLayout:e=>{R.width.value=e.nativeEvent.layout.width,R.height.value=e.nativeEvent.layout.height}},a))))})),P=(e,t)=>void 0!==t.width?{width:t.width,height:t.width/e}:{width:t.height*e,height:t.height},T=e=>{const{crop:t,angle:a,resolution:n}=e,l=t.width/t.height;let i=t;const o=a%Math.PI==0,u=n.width/n.height,h=n.height/n.width;i=P(o?u:h,{width:l>=1?void 0:t.width,height:l>=1?t.height:void 0});let r=1;i.height<t.height&&(r=t.height/i.height),i.width<t.width&&(r=t.width/i.width),i.width=i.width*r,i.height=i.height*r;const s=Math.abs(i.height*Math.sin(a))+Math.abs(i.width*Math.cos(a)),c=Math.abs(i.height*Math.cos(a))+Math.abs(i.width*Math.sin(a));return P(u,{width:u>=1?void 0:s,height:u>=1?c:void 0})};function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},z.apply(this,arguments)}const I=2*Math.PI,O=180/Math.PI,V=v.default.create({root:{flex:1},absolute:{position:"absolute"},center:{justifyContent:"center",alignItems:"center"}}),X=function(e){return(0,n.forwardRef)(((t,a)=>{const{minScale:l,maxScale:i}=t;if(void 0!==l&&l<1)throw new Error("minScale property must be greater than or equals one");if(void 0!==i&&i<1)throw new Error("maxScale property must be greater than or equals one");if(void 0!==l&&void 0!==i&&l>i)throw new Error("minScale property must not be greater than maxScale");return n.createElement(e,z({},t,{reference:a}))}))}((e=>{const{reference:t,children:a,cropSize:h,resolution:r,minScale:s=1,maxScale:v,scaleMode:d="bounce",panMode:w="free",allowPinchPanning:m=!0,onUpdate:y,onGestureEnd:p,OverlayComponent:f,onPanStart:M,onPanEnd:E,onPinchStart:P,onPinchEnd:z,onTap:X}=e,Y=T({crop:h,resolution:r,angle:0}),C=o(0,0),A=o(0,0),G=(0,l.useSharedValue)(s),D=(0,l.useSharedValue)(s),J=(0,l.useSharedValue)(0),R=o(0,0),U=u(Y.width,Y.height),j=u(Y.width,Y.height),k=(0,l.useSharedValue)(0),F=(0,l.useDerivedValue)((()=>{const{width:e,height:t}=U,a=g({width:e.value,height:t.value},r);return v??a}),[U,v,r]);(0,l.useDerivedValue)((()=>{const e=T({crop:h,resolution:r,angle:k.value});U.width.value=(0,l.withTiming)(e.width),U.height.value=(0,l.withTiming)(e.height);const t=J.value%Math.PI!=0;j.width.value=t?e.height:e.width,j.height.value=t?e.width:e.height}),[h,r,k,J]),(0,l.useDerivedValue)((()=>{null==y||y({width:U.width.value,height:U.height.value,translateX:C.x.value,translateY:C.y.value,scale:G.value,rotate:J.value,rotateX:R.x.value,rotateY:R.y.value})}),[U,C,G,R,J]);const H=e=>{const t=e??G.value;let a={width:U.width.value,height:U.height.value};return J.value%Math.PI!=0&&(a={width:a.height,height:a.width}),{x:Math.max(0,a.width*t-h.width)/2,y:Math.max(0,a.height*t-h.height)/2}},{gesturesEnabled:Z,onTouchesDown:W,onTouchesMove:L,onTouchesUp:$,onPinchStart:q,onPinchUpdate:_,onPinchEnd:B}=S({container:j,translate:C,offset:A,scale:G,scaleOffset:D,minScale:s,maxScale:F,allowPinchPanning:m,scaleMode:d,pinchCenteringMode:"sync",boundFn:H,userCallbacks:{onGestureEnd:p,onPinchStart:P,onPinchEnd:z}}),{onPanStart:N,onPanChange:K,onPanEnd:Q}=x({container:j,translate:C,offset:A,panMode:w,boundFn:H,userCallbacks:{onGestureEnd:p,onPanStart:M,onPanEnd:E}}),ee=i.Gesture.Pinch().withTestId("pinch").manualActivation(!0).onTouchesDown(W).onTouchesMove(L).onTouchesUp($).onStart(q).onUpdate(_).onEnd(B),te=i.Gesture.Pan().withTestId("pan").enabled(Z).maxPointers(1).onStart(N).onChange(K).onEnd(Q),ae=i.Gesture.Tap().withTestId("tap").enabled(Z).maxDuration(250).numberOfTaps(1).runOnJS(!0).onEnd((e=>null==X?void 0:X(e))),ne=(0,l.useAnimatedStyle)((()=>({width:j.width.value,height:j.height.value,position:"absolute",transform:[{translateX:C.x.value},{translateY:C.y.value},{scale:G.value}]})),[j,C,G]),le=(0,l.useAnimatedStyle)((()=>({width:U.width.value,height:U.height.value,transform:[{translateX:C.x.value},{translateY:C.y.value},{scale:G.value},{rotate:`${J.value}rad`},{rotateX:`${R.x.value}rad`},{rotateY:`${R.y.value}rad`}]})),[U,C,G,J,R]),ie=(e,t=!0)=>{C.x.value=t?(0,l.withTiming)(e.translateX):e.translateX,C.y.value=t?(0,l.withTiming)(e.translateY):e.translateY,G.value=t?(0,l.withTiming)(e.scale):e.scale,D.value=e.scale,R.x.value=t?(0,l.withTiming)(e.rotateX):e.rotateX,R.y.value=t?(0,l.withTiming)(e.rotateY):e.rotateY,J.value=t?(0,l.withTiming)(e.rotate,void 0,(()=>{oe.value=!0,J.value=J.value%I})):e.rotate%I},oe=(0,l.useSharedValue)(!0),ue=(e=!0,t=!0,a)=>{if(!oe.value)return;e&&(oe.value=!1);const n=t?1:-1,l=J.value+n*(Math.PI/2);k.value=l,null==a||a(l%I),ie({translateX:0,translateY:0,scale:s,rotate:l,rotateX:R.x.value,rotateY:R.y.value},e)},he=(e=!0,t)=>{const a=R.y.value!==Math.PI?Math.PI:0;null==t||t(a*O),R.y.value=e?(0,l.withTiming)(a):a},re=(e=!0,t)=>{const a=R.x.value!==Math.PI?Math.PI:0;null==t||t(a*O),R.x.value=e?(0,l.withTiming)(a):a},se=e=>{const t={rotationAngle:J.value*O,flipHorizontal:R.y.value===Math.PI,flipVertical:R.x.value===Math.PI},a=(e=>{const{cropSize:t,itemSize:a,resolution:n,translation:l,scale:i,isRotated:o,fixedWidth:u}=e,h=b({scale:i,containerSize:t,itemSize:{width:o?a.height:a.width,height:o?a.width:a.height},translation:l}),r=n.width/a.width,s=h.x*r,c=h.y*r,v=h.width*r,d=h.height*r;let g,w=1;return void 0!==u&&(w=u/v,g={width:Math.ceil(n.width*w),height:Math.ceil(n.height*w)}),{crop:{originX:s*w,originY:c*w,width:Math.round(v*w),height:Math.round(d*w)},resize:g}})({scale:G.value,cropSize:h,resolution:r,itemSize:{width:U.width.value,height:U.height.value},translation:{x:C.x.value,y:C.y.value},isRotated:t.rotationAngle%180!=0,fixedWidth:e});return{crop:a.crop,resize:a.resize,context:t}},ce=()=>({width:U.width.value,height:U.height.value,translateX:C.x.value,translateY:C.y.value,scale:G.value,rotate:J.value,rotateX:R.x.value,rotateY:R.y.value}),ve=(e,t=!0)=>{const a=(0,l.clamp)(e.scale,s,F.value),{x:n,y:i}=H(a),o=(0,l.clamp)(e.translateX,-1*n,n),u=(0,l.clamp)(e.translateY,-1*i,i),h=Math.PI/2,r=Math.floor(e.rotate%(2*Math.PI)/h)*h,c=1===Math.sign(e.rotateX-h)?Math.PI:0,v=1===Math.sign(e.rotateY-h)?Math.PI:0;ie({translateX:o,translateY:u,scale:a,rotate:r,rotateX:c,rotateY:v},t)};(0,n.useImperativeHandle)(t,(()=>({rotate:ue,flipHorizontal:he,flipVertical:re,reset:e=>ie({translateX:0,translateY:0,scale:s,rotate:0,rotateX:0,rotateY:0},e),crop:se,requestState:ce,assignState:ve})));const de={minWidth:h.width,minHeight:h.height};return n.createElement(c.default,{style:[de,V.root,V.center]},n.createElement(l.default.View,{style:le},a),n.createElement(c.default,{style:V.absolute,pointerEvents:"none"},null==f?void 0:f()),n.createElement(i.GestureDetector,{gesture:i.Gesture.Race(ee,te,ae)},n.createElement(l.default.View,{style:ne})))})),Y=e=>{const{index:t,itemSize:a,gap:n}=e;return t*a+t*n},C=n.createContext({}),A={duration:300,easing:l.Easing.linear},G=({length:e,gap:t,maxScale:a,itemSize:u,vertical:h,tapOnEdgeToItem:r,zoomEnabled:s,scaleMode:c,allowOverflow:v,allowPinchPanning:g,pinchCenteringMode:w,onTap:x,onPanStart:y,onPanEnd:f,onPinchStart:M,onPinchEnd:E,onSwipe:P,onVerticalPull:T,onGestureEnd:z})=>{const{activeIndex:I,scroll:O,scrollOffset:V,isScrolling:X,rootSize:G,rootChildSize:D,translate:J,scale:R,overflow:U,hideAdjacentItems:j}=(0,n.useContext)(C),k=o(0,0),F=(0,l.useSharedValue)(1),H=(0,l.useSharedValue)(0),Z=o(0,0),W=(0,l.useSharedValue)(0),L=(0,l.useSharedValue)(!1),$=(0,l.useSharedValue)(!1),q=e=>{const t=e??R.value,{width:a,height:n}=D,{width:l,height:i}=G;return{x:Math.max(0,a.value*t-l.value)/2,y:Math.max(0,n.value*t-i.value)/2}},_=(e,t,a,n=!0)=>{(0,l.cancelAnimation)(J.x),(0,l.cancelAnimation)(J.y),(0,l.cancelAnimation)(R),J.x.value=n?(0,l.withTiming)(e):e,J.y.value=n?(0,l.withTiming)(t):t,R.value=n?(0,l.withTiming)(a):a,F.value=a};(0,l.useAnimatedReaction)((()=>({translate:J.y.value,isPulling:L.value,released:$.value})),(e=>{e.isPulling&&(null==T||T(e.translate,e.released))}),[J,L,$]),(0,l.useAnimatedReaction)((()=>({width:G.width.value,height:G.height.value})),(()=>_(0,0,1,!1)),[G]);const{gesturesEnabled:B,onTouchesDown:N,onTouchesMove:K,onTouchesUp:Q,onPinchStart:ee,onPinchUpdate:te,onPinchEnd:ae}=S({container:G,translate:J,offset:k,scale:R,scaleOffset:F,minScale:1,maxScale:a,scaleMode:c,allowPinchPanning:g,pinchCenteringMode:w,boundFn:q,userCallbacks:{onPinchStart:M,onPinchEnd:E,onGestureEnd:()=>{U.value="hidden",j.value=!1,null==z||z()}}}),{onDoubleTapEnd:ne}=p({container:G,translate:J,scale:R,minScale:1,maxScale:a,scaleOffset:F,boundsFn:q,onGestureEnd:z}),le=i.Gesture.Pinch().withTestId("pinch").enabled(s).manualActivation(!0).onTouchesDown(N).onTouchesMove(K).onTouchesUp(Q).onStart((e=>{v&&(U.value="visible",j.value=!0),ee(e)})).onUpdate(te).onEnd(ae),ie=i.Gesture.Pan().withTestId("pan").maxPointers(1).minVelocity(100).enabled(B).onStart((e=>{y&&(0,l.runOnJS)(y)(e),(0,l.cancelAnimation)(J.x),(0,l.cancelAnimation)(J.y),(0,l.cancelAnimation)(O);const t=Math.abs(e.velocityY)>Math.abs(e.velocityX);L.value=t&&1===R.value&&!h,X.value=!0,H.value=performance.now(),Z.x.value=e.absoluteX,Z.y.value=e.absoluteY,V.value=O.value,k.x.value=J.x.value,k.y.value=J.y.value})).onUpdate((a=>{if(L.value)return void(J.y.value=a.translationY);const n=k.x.value+a.translationX,l=k.y.value+a.translationY,{x:i,y:o}=q(R.value),r=Math.max(0,Math.abs(n)-i),s=Math.max(0,Math.abs(l)-o),c=-1*Math.sign(n)*r,v=-1*Math.sign(l)*s,g=V.value+(h?v:c),w=e-1;O.value=d(g,0,w*u.value+w*t),J.x.value=d(n,-1*i,i),J.y.value=d(l,-1*o,o)})).onEnd((a=>{const n=q(R.value),i=m(a,{boundaries:n,time:H.value,position:{x:Z.x.value,y:Z.y.value},translate:{x:L.value?100:J.x.value,y:L.value?0:J.y.value}});if(void 0!==i&&(a=>{(0,l.cancelAnimation)(O);let n=I.value;if("up"===a&&h&&(n+=1),"down"===a&&h&&(n-=1),"left"!==a||h||(n+=1),"right"!==a||h||(n-=1),n=d(n,0,e-1),n===I.value)return;const i=Y({index:n,itemSize:u.value,gap:t});O.value=(0,l.withTiming)(i,A,(e=>{e&&(I.value=n,X.value=!1,_(0,0,1,!1))}))})(i),void 0!==i&&P&&(0,l.runOnJS)(P)(i),L.value)return $.value=!0,void(J.y.value=(0,l.withTiming)(0,void 0,(e=>{L.value=!e,$.value=!e})));(h&&(void 0===i||"left"===i||"right"===i)||!h&&(void 0===i||"up"===i||"down"===i))&&(a=>{(0,l.cancelAnimation)(O);const n=Y({index:d(I.value-1,0,e-1),itemSize:u.value,gap:t}),i=Y({index:I.value,itemSize:u.value,gap:t}),o=Y({index:d(I.value+1,0,e-1),itemSize:u.value,gap:t}),r=h?a.velocityY:a.velocityX,s=((e,t,a)=>{const n=e+.05*t,l=a.map((e=>Math.abs(n-e))),i=Math.min.apply(null,l);return a.filter((e=>Math.abs(n-e)===i))[0]})(O.value,r,[n,i,o]);O.value=(0,l.withTiming)(s,A,(e=>{e&&(s!==i&&(I.value+=s===o?1:-1),X.value=!1,s!==i&&_(0,0,1,!1))}))})(a),void 0===i&&f&&(0,l.runOnJS)(f)(a);const o={velocity:a.velocityX,clamp:[-n.x,n.x]},r={velocity:a.velocityY,clamp:[-n.y,n.y]},s=Math.abs(Math.abs(J.x.value)-n.x),c=Math.abs(Math.abs(J.y.value)-n.y),v=s>c?o:r;W.value=s>c?J.x.value:J.y.value,W.value=(0,l.withDecay)(v,(()=>{z&&(0,l.runOnJS)(z)()})),J.x.value=(0,l.withDecay)(o),J.y.value=(0,l.withDecay)(r)})),oe=i.Gesture.Tap().withTestId("tap").enabled(B).numberOfTaps(1).maxDuration(250).onEnd((a=>{const n={width:G.width.value,height:G.height.value},i=b({scale:R.value,containerSize:n,itemSize:n,translation:{x:J.x.value,y:J.y.value}}),o=44/R.value,s=i.x+o,c=i.x+i.width-o;let v=I.value;const g=r&&!h;if(a.x<=s&&g&&(v-=1),a.x>=c&&g&&(v+=1),v=d(v,0,e-1),v===I.value)return void(x&&(0,l.runOnJS)(x)(a,I.value));const w=Y({index:v,itemSize:u.value,gap:t});O.value=w,I.value=v,_(0,0,1,!1)})),ue=i.Gesture.Tap().withTestId("doubleTap").enabled(B&&s).numberOfTaps(2).maxDuration(250).onEnd(ne),he=(0,l.useAnimatedStyle)((()=>({width:Math.max(G.width.value,D.width.value),height:Math.max(G.height.value,D.height.value),position:"absolute",zIndex:2147483647,transform:[{translateX:J.x.value},{translateY:J.y.value},{scale:R.value}]})),[G,D,J,R]),re=i.Gesture.Race(ie,le,i.Gesture.Exclusive(ue,oe));return n.createElement(i.GestureDetector,{gesture:re},n.createElement(l.default.View,{style:he}))},D=n.memo(G,((e,t)=>e.onTap===t.onTap&&e.onPanStart===t.onPanStart&&e.onPanEnd===t.onPanEnd&&e.onPinchStart===t.onPinchStart&&e.onPinchEnd===t.onPinchEnd&&e.onSwipe===t.onSwipe&&e.length===t.length&&e.vertical===t.vertical&&e.tapOnEdgeToItem===t.tapOnEdgeToItem&&e.zoomEnabled===t.zoomEnabled&&e.scaleMode===t.scaleMode&&e.allowPinchPanning===t.allowPinchPanning&&e.allowOverflow===t.allowOverflow&&e.pinchCenteringMode===t.pinchCenteringMode&&e.onVerticalPull===t.onVerticalPull)),J=({index:e,gap:t,zIndex:a,item:i,vertical:h,renderItem:r,customTransition:s})=>{const{rootSize:c,rootChildSize:v,activeIndex:d,scroll:g,isScrolling:w,translate:m,scale:x,overflow:y,hideAdjacentItems:S}=(0,n.useContext)(C),p=u(0,0),f=o(0,0),b=(0,l.useSharedValue)(1),M=(0,l.useAnimatedStyle)((()=>({transform:[{translateX:f.x.value},{translateY:f.y.value},{scale:b.value}]})),[f,b]),E=(0,l.useAnimatedStyle)((()=>({width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",overflow:y.value,opacity:d.value!==e&&S.value?0:1})),[y,d,e,S]),P=(0,l.useAnimatedStyle)((()=>{if(void 0!==s)return s({index:e,gap:t,activeIndex:d.value,isScrolling:w.value,direction:h?"vertical":"horizontal",scroll:g.value,gallerySize:{width:c.width.value,height:c.height.value}});const a=-1*g.value+e*t,n=0===c.width.value&&0===c.height.value&&e!==d.value?0:1;return h?{transform:[{translateY:e*c.height.value+a}],opacity:n}:{transform:[{translateX:e*c.width.value+a}],opacity:n}}));return(0,l.useAnimatedReaction)((()=>({activeIndex:d.value,translate:{x:m.x.value,y:m.y.value},scale:x.value})),(t=>{e===t.activeIndex&&(f.x.value=t.translate.x,f.y.value=t.translate.y,b.value=t.scale)}),[d,m,x]),(0,l.useAnimatedReaction)((()=>d.value),(t=>{e===t?(v.width.value=p.width.value,v.height.value=p.height.value):(f.x.value=0,f.y.value=0,b.value=1)}),[d,p]),n.createElement(l.default.View,{testID:`child-${e}`,style:[E,P,{zIndex:a}]},n.createElement(l.default.View,{style:M,onLayout:t=>{p.width.value=t.nativeEvent.layout.width,p.height.value=t.nativeEvent.layout.height,e===d.value&&(v.width.value=t.nativeEvent.layout.width,v.height.value=t.nativeEvent.layout.height)}},r(i,e)))},R=n.memo(J,((e,t)=>e.index===t.index&&e.gap===t.gap&&e.zIndex===t.zIndex&&e.vertical===t.vertical&&e.customTransition===t.customTransition&&e.renderItem===t.renderItem)),U=e=>{const{reference:t,data:a,renderItem:i,keyExtractor:o,initialIndex:u=0,windowSize:h=5,maxScale:r=6,vertical:s=!1,gap:c=0,allowOverflow:v=!1,tapOnEdgeToItem:w=!0,zoomEnabled:m=!0,scaleMode:x="bounce",pinchCenteringMode:y="clamp",allowPinchPanning:S=!0,customTransition:p,onIndexChange:f,onScroll:b,onTap:M,onUpdate:E,onPanStart:P,onPanEnd:T,onPinchStart:z,onPinchEnd:I,onSwipe:O,onZoomBegin:V,onZoomEnd:X,onVerticalPull:A,onGestureEnd:G}=e,{activeIndex:J,rootSize:U,rootChildSize:j,scroll:k,translate:F,scale:H,hasZoomed:Z,overflow:W}=(0,n.useContext)(C),L=Math.floor(h/2),[$,q]=(0,n.useState)(u),_=(0,l.useDerivedValue)((()=>s?U.height.value:U.width.value),[s,U]),B=(0,l.useDerivedValue)((()=>"object"==typeof r?0===r.length?6:g({width:j.width.value,height:j.height.value},r[J.value]):r),[r,J,j]),N=(0,l.useAnimatedStyle)((()=>({flex:1,justifyContent:"center",alignItems:"center",overflow:W.value})),[W]);(0,l.useAnimatedReaction)((()=>({scroll:k.value,itemSize:_.value})),(e=>null==b?void 0:b(e.scroll,(a.length-1)*e.itemSize)),[k,_]),(0,l.useAnimatedReaction)((()=>({width:j.width.value,height:j.height.value,translateX:F.x.value,translateY:F.y.value,scale:H.value})),(e=>E&&E(e)),[j,F,H]),(0,l.useAnimatedReaction)((()=>J.value),(e=>{f&&(0,l.runOnJS)(f)(e),(0,l.runOnJS)(q)(e)}),[J]),(0,l.useAnimatedReaction)((()=>({vertical:s,size:{width:U.width.value,height:U.height.value}})),(e=>{k.value=Y({index:J.value,itemSize:e.vertical?e.size.height:e.size.width,gap:c})}),[s,U]),(0,l.useAnimatedReaction)((()=>H.value),((e,t)=>{1===e||Z.value?1===e&&1!==t&&Z.value&&(Z.value=!1,X&&(0,l.runOnJS)(X)(J.value)):(Z.value=!0,V&&(0,l.runOnJS)(V)(J.value))}),[H]);const K=e=>{const t=d(e,0,a.length-1);J.value=t,k.value=Y({index:J.get(),itemSize:_.get(),gap:c})},Q=()=>({width:j.width.get(),height:j.height.get(),translateX:F.x.get(),translateY:F.y.get(),scale:H.get()}),ee=(e=!0)=>{F.x.value=e?(0,l.withTiming)(0):0,F.y.value=e?(0,l.withTiming)(0):0,H.value=e?(0,l.withTiming)(1):1};return(0,n.useImperativeHandle)(t,(()=>({setIndex:K,reset:ee,requestState:Q}))),n.createElement(l.default.View,{testID:"root",style:N,onLayout:e=>{const{width:t,height:a}=e.nativeEvent.layout,n=Y({index:J.get(),itemSize:s?a:t,gap:c});U.width.set(t),U.height.set(a),k.set(n)}},a.map(((e,t)=>{if(t<$-L||t>$+L)return null;const l=(null==o?void 0:o(e,t))??`item-${t}`;return n.createElement(R,{key:l,zIndex:a.length-t,index:t,gap:c,item:e,vertical:s,renderItem:i,customTransition:p})})),n.createElement(D,{gap:c,maxScale:B,itemSize:_,length:a.length,vertical:s,tapOnEdgeToItem:w,zoomEnabled:m,scaleMode:x,allowOverflow:v,allowPinchPanning:S,pinchCenteringMode:y,onTap:M,onPanStart:P,onPanEnd:T,onPinchStart:z,onPinchEnd:I,onSwipe:O,onVerticalPull:A,onGestureEnd:G}))};function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},j.apply(this,arguments)}const k=(e,t)=>{const a=d(e.initialIndex??0,0,e.data.length-1),i=(0,l.useSharedValue)(a),h=u(0,0),r=u(0,0),s=o(0,0),c=(0,l.useSharedValue)(1),v={rootSize:h,rootChildSize:r,scroll:(0,l.useSharedValue)(0),scrollOffset:(0,l.useSharedValue)(0),translate:s,activeIndex:i,isScrolling:(0,l.useSharedValue)(!1),scale:c,hasZoomed:(0,l.useSharedValue)(!1),overflow:(0,l.useSharedValue)("hidden"),hideAdjacentItems:(0,l.useSharedValue)(!1)};return n.createElement(C.Provider,{value:v},n.createElement(U,j({},e,{initialIndex:a,reference:t})))},F=(0,n.forwardRef)(k);var H=a(50728);function Z(e){const[t,a]=(0,n.useState)(!0),[l,i]=(0,n.useState)(void 0),[o,u]=(0,n.useState)(void 0),h=(e,t)=>{u({width:e,height:t}),a(!1)},r=e=>{i(e),a(!1)},s=JSON.stringify(e);return(0,n.useEffect)((()=>{if(a(!0),"number"!=typeof e)void 0!==e.headers?H.default.getSizeWithHeaders(e.uri,e.headers,h,r):H.default.getSize(e.uri,h,r);else{const{width:t,height:a}=H.default.resolveAssetSource(e);h(t,a)}}),[s]),{isFetching:t,resolution:o,error:l}}var W=a(63384);const{width:L,height:$}=W.default.get("window"),q=-1*Math.max(L,$),_=e=>{const t=u(0,0),a=o(0,0),n=(0,l.useSharedValue)(1),i=o(q,q),h=u(0,0),r=o(0,0),s=(0,l.useSharedValue)(0);return{onUpdate:l=>{if(t.width.value=l.width,t.height.value=l.height,a.x.value=l.translateX,a.y.value=l.translateY,n.value=l.scale,"crop"===e){const e=l;r.x.value=e.rotateX,r.y.value=e.rotateY,s.value=e.rotate}if("snapback"===e){const e=l;e.resizedWidth&&(h.width.value=e.resizedWidth),e.resizedHeight&&(h.height.value=e.resizedHeight),i.x.value=l.x,i.y.value=l.y}},transform:(0,l.useDerivedValue)((()=>{const e=s.value,t=r.x.value,l=r.y.value,i=n.value,o=[];return o[0]=i*Math.cos(l)*Math.cos(e),o[1]=i*Math.sin(l)*Math.sin(t)*Math.cos(e)-i*Math.cos(t)*Math.sin(e),o[2]=i*Math.sin(t)*Math.sin(e)+i*Math.sin(l)*Math.cos(t)*Math.cos(e),o[3]=0,o[4]=i*Math.cos(l)*Math.sin(e),o[5]=i*Math.cos(t)*Math.cos(e)+i*Math.sin(l)*Math.sin(t)*Math.sin(e),o[6]=i*Math.sin(l)*Math.cos(t)*Math.sin(e)-i*Math.sin(t)*Math.cos(e),o[7]=0,o[8]=-1*Math.sin(l),o[9]=Math.cos(l)*Math.sin(t),o[10]=Math.cos(l)*Math.cos(t),o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,[{translateX:a.x.value},{translateY:a.y.value},{matrix:o}]}),[a,n,s,r]),state:(()=>{const l={width:t.width,height:t.height,translateX:a.x,translateY:a.y,scale:n};return"crop"===e&&(l.rotateX=r.x,l.rotateY=r.y,l.rotate=s),"snapback"===e&&(l.x=i.x,l.y=i.y,l.resizedWidth=h.width,l.resizedHeight=h.height),l})()}},B=(e,t)=>{let a=t.width,n=t.width/e;return n>t.height&&(a=t.height*e,n=t.height),{width:a,height:n}},N=e=>{const{index:t,activeIndex:a,direction:n,gallerySize:i,scroll:o,isScrolling:u}=e;if("vertical"===n)return{transform:[{translateY:t*i.height-o}]};if(t<a-1||t>a+1)return{opacity:0,transform:[{translateX:0},{scale:0}]};let h=t*i.width-o,r=1,s=1;return t===a||u||(s=0),(t===a+1||t===a&&o<t*i.width)&&(r=(0,l.interpolate)(o,[(t-1)*i.width,t*i.width],[0,1],l.Extrapolation.CLAMP),s=.75+.25*r,h=0),{opacity:r,transform:[{translateX:h},{scale:s}]}}}}]);